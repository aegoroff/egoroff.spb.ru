{% extends 'base.html' %}

{% block content %}
    <!-- Main hero unit for a primary marketing message or call to action -->
    <div class="hero-unit">
        <h1>{{ title }}</h1>

        <p>Многое из того, что написано на этом сайте сильно устарело и/или является неверным и смешным. В какой-то
            мере
            этот сайт отражает мой путь как разработчика. Полезность/бесполезность этих материалов определяйте
            сами.</p>
    </div>
    <div class="row-fluid">
        <div class="span9">
            {% if not posts %}
                Ничего нет
            {% else %}
                <dl>
                    {% for post in posts.object_list %}
                        {% include 'news/post_box.html' %}
                    {% endfor %}
                </dl>
            {% endif %}

            {% if posts.paginator.num_pages > 1 %}

                {% if "tag" in request.args %}
                    {% set tag_query = "?tag=" + request.args["tag"] %}
                {% else %}
                    {% set tag_query = "" %}
                {% endif %}
                <ul class="pager">
                    {% if posts.has_previous %}
                        <li class="previous">
                            <a href="{{ url_for(
                                'news.index',
                                page=posts.previous_page_number) }}{{ tag_query }}"
                               class="prev">
                                &larr; новее
                            </a>
                        </li>
                    {% else %}
                        <li class="disabled previous">
                            <a href="#">&larr; новее</a>
                        </li>
                    {% endif %}

                    {% if posts.has_next %}
                        <li class="next">
                            <a href="{{ url_for('news.index', page=posts.next_page_number) }}{{ tag_query }}"
                               class="next">старее &rarr;</a>
                        </li>
                    {% else %}
                        <li class="next disabled">
                            <a href="#"
                               class="next">старее &rarr;</a>
                        </li>
                    {% endif %}
                </ul>
                <div class="pagination">
                    <ul style="float: left;">
                        {% for page in posts.paginator.page_range %}
                            {% if page %}
                                {% if page == posts.number %}
                                    <li class="active">
                                        <a href="{{ url_for('news.index', page=page) }}{{ tag_query }}"
                                           class="page">{{ page }}</a>
                                    </li>
                                {% else %}
                                    <li>
                                        <a href="{{ url_for('news.index', page=page) }}{{ tag_query }}"
                                           class="page">{{ page }}</a>
                                    </li>
                                {% endif %}
                            {% else %}
                                ......
                            {% endif %}
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        </div>
        <div class="span3 tags">
            <h3>Метки</h3>
            {% if not tags %}
                <p>Ничего нет</p>
            {% else %}
                {% for tag in tags %}
                    <a href="{{ url_for('news.index') }}?tag={{ tag.title }}"
                       class={{ tag.tag_level }}>{{ tag.title }}</a>
                {% endfor %}
            {% endif %}
            <h3>Архив</h3>
            {% if not archieve %}
                <p>Ничего нет</p>
            {% else %}
                <div class="accordion" id="accordion2">
                    {% for year in archieve | sort(reverse=True) %}
                        <div class="accordion-group">
                            <div class="accordion-heading">
                                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2"
                                   href="#collapse{{ year }}">
                                    {{ year }}
                                </a>
                            </div>
                            <div id="collapse{{ year }}" class="accordion-body collapse in">
                                <div class="accordion-inner">
                                {% for month in archieve[year] %}
                                    <a href="{{ url_for('news.index') }}?year={{ year }}&month={{ month[0] }}"
                                            >{{ months[month[0]] }} ({{ month[1] }})</a><br/>
                                {% endfor %}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}